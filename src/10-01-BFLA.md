---
transition: fade
auto-animate: true
---

# API05:2023 — Broken Function Level Authorization
Who is allowed to call this function?

<div class="mt-6 space-y-6 text-lg">

<p>
The API checks <strong>authentication</strong>,  
but assumes <span v-mark.orange="1">any authenticated user</span> can access the function.
</p>

<ul class="list-disc ml-6 space-y-3 opacity-90">
  <li>Endpoint exists and works correctly</li>
  <li>User has a valid token</li>
  <li>No check on <code v-mark.red="1">role</code> or <code v-mark.red="1">permission</code></li>
</ul>

<p class="mt-3">
Result: <strong>privileged actions exposed</strong>
</p>
</div>

```ts
app.patch('/users/:id/role', async (req, res) => {
  const user = await userRepo.findById(req.params.id);

  user.role = req.body.role; // ❌ no role check
  await userRepo.save(user);

  res.json(user);
});
```
