---
layoutClass: gap-24
transition: fade
auto-animate: true
level: 2
---

# BOLA â€” enforcing ownership

<div class="mb-6 text-lg">
Same endpoint.  
Stronger <span v-mark.orange="1">rule</span>.
</div>

````md magic-move {lines: true}
```ts {*}
app.get('/api/v1/users/:id', (req, res) => {
  const user = db.findUserById(req.params.id);
  res.json(user);
});
```

```ts {*|2-6|7-9|*}
app.get('/api/v1/users/:id', validToken, async (req, res) => {
  const ownerId = req.user.azp; 
  const user = await userRepo.findOne({
    id: req.params.id,
    userId: ownerId,
  });
  if (!user) {
    throw new ForbiddenError();
  }
  return user;
});

```
````

<div class="mt-6" v-click>
Authorization is now <span v-mark.orange="4">checked</span>   
Never trust object identifiers from the client.
</div>
