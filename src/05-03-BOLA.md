---
layoutClass: gap-24
transition: fade
auto-animate: true
level: 2
---

# BOLA — enforcing ownership

<div class="mb-6 text-lg">
Same endpoint.  
Stronger <span v-mark.orange="1">rule</span>.
</div>

````md magic-move {lines: true}
```ts {*}
app.get('/api/v1/users/:id', (req, res) => {
  const user = db.findUserById(req.params.id);
  res.json(user);
});
```

```ts {*|3-5|*}
app.get('/api/v1/users/:id', async (req, res) => {
  const order = await orderRepo.findById(req.params.id);
  if (!order || order.userId !== req.user.id) {
    throw new ForbiddenError();
  }
  return order;
});
```
````

<div class="mt-6" v-click>
Authorization is now <span v-mark.orange="4">checked</span>   
Never trust object identifiers from the client.
</div>


<div class="absolute bottom-6 left-8 text-sm opacity-50" v-click>
owasp.org/API-Security/Top-10-2023 — BOLA
</div>