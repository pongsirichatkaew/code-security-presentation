---
transition: fade
auto-animate: true
---

# BFLA — enforcing function-level authorization

````md magic-move {lines: true}
```ts {*}
app.patch('/users/:id/role', async (req, res) => {
  const user = await userRepo.findById(req.params.id);

  user.role = req.body.role; // ❌ no role check
  await userRepo.save(user);

  res.json(user);
});
```

```ts {*|2-4|*}
app.patch('/users/:id/role', async (req, res) => {
  if (req.user.role !== 'admin') {
    throw new ForbiddenError();
  }

  const user = await userRepo.findById(req.params.id);
  user.role = req.body.role;

  await userRepo.save(user);
  res.json(user);
});
```
````
<div v-click="2" class="mt-6 text-lg"> Same functionality, Stronger <span v-mark.orange="2">function-level rule</span></div>

<p v-click="2" class="mt-10 text-xl font-semibold">
This is not a coding mistake.  
It’s about <span v-mark.orange="2">how the system was designed</span>.
</p>

<p v-click="2" class="mt-4 text-lg text-gray-400">
Authorization rules are part of the product design,  
not just implementation details.
</p>